<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  File: README
  
    &mdash; Documentation by YARD 0.9.26
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "README";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="file_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><div id='filecontents'><p><a href="https://rubygems.org/gems/wcc-contentful"><img src="https://badge.fury.io/rb/wcc-contentful.svg" alt="Gem Version"></a>
<a href="https://travis-ci.org/watermarkchurch/wcc-contentful"><img src="https://travis-ci.org/watermarkchurch/wcc-contentful.svg?branch=master" alt="Build Status"></a>
<a href="https://coveralls.io/github/watermarkchurch/wcc-contentful?branch=master"><img src="https://coveralls.io/repos/github/watermarkchurch/wcc-contentful/badge.svg?branch=master" alt="Coverage Status"></a></p>

<p>Full documentation: <a href="https://www.rubydoc.info/gems/wcc-contentful">https://www.rubydoc.info/gems/wcc-contentful</a></p>

<h1 id="wcc-contentful">WCC::Contentful</h1>

<h2 id="installation">Installation</h2>

<p>Add this line to your application&#39;s Gemfile:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_gem'>gem</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>wcc-contentful</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>require:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>wcc/contentful/rails</span><span class='tstring_end'>&#39;</span></span>
</code></pre>

<p>If you&#39;re not using rails, exclude the <code>require:</code> parameter.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_gem'>gem</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>wcc-contentful</span><span class='tstring_end'>&#39;</span></span>
</code></pre>

<p>And then execute:</p>

<pre class="code ruby"><code class="ruby">    $ bundle
</code></pre>

<p>Or install it yourself as:</p>

<pre class="code ruby"><code class="ruby">    $ gem install wcc-contentful
</code></pre>

<h2 id="configure">Configure</h2>

<p>Put this in an initializer:</p>

<pre class="code ruby"><code class="ruby"># config/initializers/wcc_contentful.rb
WCC::Contentful.configure do |config|
  config.access_token = &lt;CONTENTFUL_ACCESS_TOKEN&gt;
  config.space = &lt;CONTENTFUL_SPACE_ID&gt;
end

WCC::Contentful.init!
</code></pre>

<p>All configuration options can be found <a href="https://www.rubydoc.info/gems/wcc-contentful/WCC/Contentful/Configuration">in the rubydoc</a> under
<span class='object_link'><a href="WCC/Contentful/Configuration.html" title="WCC::Contentful::Configuration (class)">WCC::Contentful::Configuration</a></span></p>

<h2 id="usage">Usage</h2>

<h3 id="wcc-contentful-model-api">WCC::Contentful::Model API</h3>

<p>The WCC::Contentful::Model API exposes Contentful data as a set of dynamically
generated Ruby objects.  These objects are based on the content types in your
Contentful space.  All these objects are generated by <code>WCC::Contentful.init!</code></p>

<p>The following examples show how to use this API to find entries of the <code>page</code>
content type:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># Find objects by id
</span><span class='const'><span class='object_link'><a href="WCC.html" title="WCC (module)">WCC</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="WCC/Contentful.html" title="WCC::Contentful (module)">Contentful</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="WCC/Contentful/Model.html" title="WCC::Contentful::Model (class)">Model</a></span></span><span class='op'>::</span><span class='const'>Page</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>1E2ucWSdacxxf233sfa3</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='comment'># =&gt; #&lt;WCC::Contentful::Model::Page:0x0000000005c71a78 @created_at=2018-04-16 18:41:17 UTC...&gt;
</span>
<span class='comment'># Find objects by field
</span><span class='const'><span class='object_link'><a href="WCC.html" title="WCC (module)">WCC</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="WCC/Contentful.html" title="WCC::Contentful (module)">Contentful</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="WCC/Contentful/Model.html" title="WCC::Contentful::Model (class)">Model</a></span></span><span class='op'>::</span><span class='const'>Page</span><span class='period'>.</span><span class='id identifier rubyid_find_by'>find_by</span><span class='lparen'>(</span><span class='label'>slug:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/some-slug</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='comment'># =&gt; #&lt;WCC::Contentful::Model::Page:0x0000000005c71a78 @created_at=2018-04-16 18:41:17 UTC...&gt;
</span>
<span class='comment'># Use operators to filter by a field
</span><span class='comment'># must use full notation for sys attributes (except ID)
</span><span class='const'><span class='object_link'><a href="WCC.html" title="WCC (module)">WCC</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="WCC/Contentful.html" title="WCC::Contentful (module)">Contentful</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="WCC/Contentful/Model.html" title="WCC::Contentful::Model (class)">Model</a></span></span><span class='op'>::</span><span class='const'>Page</span><span class='period'>.</span><span class='id identifier rubyid_find_all'>find_all</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sys.created_at</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span> <span class='label'>lte:</span> <span class='const'>Date</span><span class='period'>.</span><span class='id identifier rubyid_today'>today</span> <span class='rbrace'>}</span><span class='rparen'>)</span>
<span class='comment'># =&gt; [#&lt;WCC::Contentful::Model::Page:0x0000000005c71a78 @created_at=2018-04-16 18:41:17 UTC...&gt;, ... ]
</span>
<span class='comment'># Nest queries to mimick joins
</span><span class='const'><span class='object_link'><a href="WCC.html" title="WCC (module)">WCC</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="WCC/Contentful.html" title="WCC::Contentful (module)">Contentful</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="WCC/Contentful/Model.html" title="WCC::Contentful::Model (class)">Model</a></span></span><span class='op'>::</span><span class='const'>Page</span><span class='period'>.</span><span class='id identifier rubyid_find_by'>find_by</span><span class='lparen'>(</span><span class='label'>subpages:</span> <span class='lbrace'>{</span> <span class='label'>slug:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/some-slug</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span><span class='rparen'>)</span>
<span class='comment'># =&gt; #&lt;WCC::Contentful::Model::Page:0x0000000005c71a78 @created_at=2018-04-16 18:41:17 UTC...&gt;
</span>
<span class='comment'># Pass the preview flag to use the preview client (must have set preview_token config param)
</span><span class='id identifier rubyid_preview_redirect'>preview_redirect</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="WCC.html" title="WCC (module)">WCC</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="WCC/Contentful.html" title="WCC::Contentful (module)">Contentful</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="WCC/Contentful/Model.html" title="WCC::Contentful::Model (class)">Model</a></span></span><span class='op'>::</span><span class='const'>Redirect</span><span class='period'>.</span><span class='id identifier rubyid_find_by'>find_by</span><span class='lparen'>(</span><span class='lbrace'>{</span> <span class='label'>slug:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>draft-redirect</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>preview:</span> <span class='kw'>true</span><span class='rparen'>)</span>
<span class='comment'># =&gt; #&lt;WCC::Contentful::Model::Redirect:0x0000000005d879ad @created_at=2018-04-16 18:41:17 UTC...&gt;
</span><span class='id identifier rubyid_preview_redirect_object'>preview_redirect_object</span><span class='period'>.</span><span class='id identifier rubyid_href'>href</span>
<span class='comment'># =&gt; &#39;http://www.somesite.com/slug-for-redirect&#39;
</span></code></pre>

<p>See the <span class='object_link'><a href="WCC/Contentful/Model.html" title="WCC::Contentful::Model (class)">WCC::Contentful::Model</a></span> documentation for more details.</p>

<h3 id="store-api">Store API</h3>

<p>The Store layer is used by the Model API to access Contentful data in a raw form.
The Store layer returns entries as hashes parsed from JSON, conforming to the
object structure returned from the Contentful CDN.</p>

<p>The following examples show how to use the Store API to retrieve raw data from
the store:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_store'>store</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="WCC.html" title="WCC (module)">WCC</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="WCC/Contentful.html" title="WCC::Contentful (module)">Contentful</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="WCC/Contentful/Services.html" title="WCC::Contentful::Services (class)">Services</a></span></span><span class='period'>.</span><span class='id identifier rubyid_instance'><span class='object_link'><a href="WCC/Contentful/Services.html#instance-class_method" title="WCC::Contentful::Services.instance (method)">instance</a></span></span><span class='period'>.</span><span class='id identifier rubyid_store'>store</span>
<span class='comment'># =&gt; #&lt;WCC::Contentful::Store::CDNAdapter:0x00007fb92a221498
</span>
<span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>5FsqsbMECsM62e04U8sY4Y</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='comment'># =&gt; {&quot;sys&quot;=&gt;
</span><span class='comment'>#  ...
</span><span class='comment'># &quot;fields&quot;=&gt;
</span><span class='comment'># ...}
</span>
<span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_find_by'>find_by</span><span class='lparen'>(</span><span class='label'>content_type:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>page</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>filter:</span> <span class='lbrace'>{</span> <span class='label'>slug:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/some-slug</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span><span class='rparen'>)</span>
<span class='comment'># =&gt; {&quot;sys&quot;=&gt;
</span><span class='comment'>#  ...
</span><span class='comment'># &quot;fields&quot;=&gt;
</span><span class='comment'># ...}
</span>
<span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_find_all'>find_all</span><span class='lparen'>(</span><span class='label'>content_type:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>page</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_eq'>eq</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>group</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>some-group</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='comment'># =&gt; #&lt;WCC::Contentful::Store::CDNAdapter::Query:0x00007fa3d40b84f0
</span><span class='id identifier rubyid_query'>query</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
<span class='comment'># =&gt; {&quot;sys&quot;=&gt;
</span><span class='comment'>#  ...
</span><span class='comment'># &quot;fields&quot;=&gt;
</span><span class='comment'># ...}
</span><span class='id identifier rubyid_query'>query</span><span class='period'>.</span><span class='id identifier rubyid_result'>result</span>
<span class='comment'># =&gt; #&lt;Enumerator::Lazy: ...&gt;
</span><span class='id identifier rubyid_query'>query</span><span class='period'>.</span><span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_force'>force</span>
<span class='comment'># =&gt; [{&quot;sys&quot;=&gt; ...}, {&quot;sys&quot;=&gt; ...}, ...]
</span></code></pre>

<p>See the <span class='object_link'><a href="WCC/Contentful/Store.html" title="WCC::Contentful::Store (module)">WCC::Contentful::Store</a></span> documentation for more details.</p>

<h3 id="direct-cdn-api-simpleclient">Direct CDN API (SimpleClient)</h3>

<p>The SimpleClient is the bottom layer, and is used to get raw data directly from
the Contentful CDN.  It handles response parsing and paging, but does not resolve
links or transform the result into a Model class.</p>

<p>The following examples show how to use the SimpleClient to retrieve data directly
from the Contentful CDN:</p>

<pre class="code ruby"><code class="ruby">client = WCC::Contentful::Services.instance.client
# =&gt; #&lt;WCC::Contentful::SimpleClient::Cdn:0x00007fa3cde89310

response = client.entry(&#39;5FsqsbMECsM62e04U8sY4Y&#39;)
# =&gt; #&lt;WCC::Contentful::SimpleClient::Response:0x00007fa3d103a4e0
response.body
# =&gt; &quot;{\n  \&quot;sys\&quot;: {\n ...
response.raw
# =&gt; {&quot;sys&quot;=&gt;
#  ...
# &quot;fields&quot;=&gt;
# ...}

client.asset(&#39;5FsqsbMECsM62e04U8sY4Y&#39;).raw
# =&gt; {&quot;sys&quot;=&gt;
#  ...
# &quot;fields&quot;=&gt;
# ...}

response = client.entries(&#39;fields.group&#39; =&gt; &#39;some-group&#39;, &#39;limit&#39; =&gt; 5)
# =&gt; #&lt;WCC::Contentful::SimpleClient::Response:0x00007fa3d103a4e0
response.count
# =&gt; 99
response.first
# =&gt; {&quot;sys&quot;=&gt;
#  ...
# &quot;fields&quot;=&gt;
# ...}
response.items
=&gt; #&lt;Enumerator::Lazy: ...&gt;
response.items.count  # Careful! This evaluates the lazy iterator and gets all pages
# =&gt; 99

response.includes
# =&gt; {&quot;4xNnFJ77egkSMEogE2yISa&quot;=&gt;
#   {&quot;sys&quot;=&gt; ...}
#  &quot;6Fwukxxkxa6qQCC04WCaqg&quot;=&gt;
#   {&quot;sys&quot;=&gt; ...}
#   ...}
</code></pre>

<p>The client handles Paging automatically within the lazy iterator returned by #items.
This lazy iterator does not respect the <code>limit</code> param - that param is only passed
through to the API to set the page size.  If you truly want a limited subset of
response items, use <a href="https://ruby-doc.org/core-2.5.3/Enumerable.html#method-i-take"><code>response.items.take(n)</code></a></p>

<p>Entries included via the <code>include</code> parameter are made available on the #includes
field.  This is a hash of <code>&lt;entry ID&gt; =&gt; &lt;raw entry&gt;</code> and makes it easy to grab
links.  This hash is added to lazily as you enumerate the pages.</p>

<p>See the <span class='object_link'><a href="WCC/Contentful/SimpleClient.html" title="WCC::Contentful::SimpleClient (class)">WCC::Contentful::SimpleClient</a></span> documentation for more details.</p>

<h3 id="accessing-the-apis-within-application-code">Accessing the APIs within application code</h3>

<p>The Model API is best exposed by defining your own model classes in the <code>app/models</code>
directory which inherit from the WCC::Contentful models.</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># app/models/page.rb
</span><span class='kw'>class</span> <span class='const'>Page</span> <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="WCC.html" title="WCC (module)">WCC</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="WCC/Contentful.html" title="WCC::Contentful (module)">Contentful</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="WCC/Contentful/Model.html" title="WCC::Contentful::Model (class)">Model</a></span></span><span class='op'>::</span><span class='const'>Page</span>

  <span class='comment'># You can add additional methods here
</span><span class='kw'>end</span>

<span class='comment'># app/controllers/pages_controller.rb
</span><span class='kw'>class</span> <span class='const'>PagesController</span> <span class='op'>&lt;</span> <span class='const'>ApplicationController</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_show'>show</span>
    <span class='ivar'>@page</span> <span class='op'>=</span> <span class='const'>Page</span><span class='period'>.</span><span class='id identifier rubyid_find_by'>find_by</span><span class='lparen'>(</span><span class='label'>slug:</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:slug</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>Exceptions</span><span class='op'>::</span><span class='const'>PageNotFoundError</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:slug</span><span class='rbracket'>]</span> <span class='kw'>unless</span> <span class='ivar'>@page</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</code></pre>

<p>The <span class='object_link'><a href="WCC/Contentful/Services.html" title="WCC::Contentful::Services (class)">WCC::Contentful::Services</a></span> singleton gives access to the other configured services.
You can also include the <span class='object_link'><a href="WCC/Contentful/ServiceAccessors.html" title="WCC::Contentful::ServiceAccessors (module)">WCC::Contentful::ServiceAccessors</a></span> concern to define these
services as attributes in a class.</p>

<pre class="code ruby"><code class="ruby">class MyJob &lt; ApplicationJob
  include WCC::Contentful::ServiceAccessors

  def perform
    Page.find(...)

    store.find(...)

    client.entries(...)
  end
end
</code></pre>

<h2 id="architecture">Architecture</h2>

<p><img src="./doc/wcc-contentful.png" alt="wcc-contentful diagram"></p>

<h2 id="test-helpers">Test Helpers</h2>

<p>To use the test helpers, include the following in your rails_helper.rb:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>wcc/contentful/rspec</span><span class='tstring_end'>&#39;</span></span>
</code></pre>

<p>This adds the following helpers to all your specs:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'>##
</span><span class='comment'># Builds a in-memory instance of the Contentful model for the given content_type.
</span><span class='comment'># All attributes that are known to be required fields on the content type
</span><span class='comment'># will return a default value based on the field type.
</span><span class='id identifier rubyid_instance'>instance</span> <span class='op'>=</span> <span class='id identifier rubyid_contentful_create'>contentful_create</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>my-content-type</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>my_field:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>some-value</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='comment'># =&gt; #&lt;WCC::Contentful::Model::MyContentType:0x0000000005c71a78 @created_at=2018-04-16 18:41:17 UTC...&gt;
</span>
<span class='id identifier rubyid_instance'>instance</span><span class='period'>.</span><span class='id identifier rubyid_my_field'>my_field</span>
<span class='comment'># =&gt; &quot;some-value&quot;
</span>
<span class='id identifier rubyid_instance'>instance</span><span class='period'>.</span><span class='id identifier rubyid_other_required_field'>other_required_field</span>
<span class='comment'># =&gt; &quot;default-value&quot;
</span>
<span class='id identifier rubyid_instance'>instance</span><span class='period'>.</span><span class='id identifier rubyid_other_optional_field'>other_optional_field</span>
<span class='comment'># =&gt; nil
</span>
<span class='id identifier rubyid_instance'>instance</span><span class='period'>.</span><span class='id identifier rubyid_not_a_field'>not_a_field</span>
<span class='comment'># NoMethodError: undefined method `not_a_field&#39; for #&lt;MyContentType:0x00007fbac81ee490&gt;
</span>
<span class='comment'>##
</span><span class='comment'># Builds a rspec double of the Contentful model for the given content_type.
</span><span class='comment'># All attributes that are known to be required fields on the content type
</span><span class='comment'># will return a default value based on the field type.
</span><span class='id identifier rubyid_dbl'>dbl</span> <span class='op'>=</span> <span class='id identifier rubyid_contentful_double'>contentful_double</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>my-content-type</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>my_field:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>other-value</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='comment'># =&gt; #&lt;Double (anonymous)&gt;
</span>
<span class='id identifier rubyid_dbl'>dbl</span><span class='period'>.</span><span class='id identifier rubyid_my_field'>my_field</span>
<span class='comment'># =&gt; &quot;other-value&quot;
</span>
<span class='id identifier rubyid_dbl'>dbl</span><span class='period'>.</span><span class='id identifier rubyid_other_optional_field'>other_optional_field</span>
<span class='comment'># =&gt; nil
</span>
<span class='id identifier rubyid_dbl'>dbl</span><span class='period'>.</span><span class='id identifier rubyid_not_a_field'>not_a_field</span>
<span class='comment'># =&gt; #&lt;Double (anonymous)&gt; received unexpected message :not_a_field with (no args)
</span>
<span class='comment'>##
</span><span class='comment'># Builds out a fake Contentful entry for the given content type, and then
</span><span class='comment'># stubs the Model API to return that content type for `.find` and `.find_by`
</span><span class='comment'># query methods.
</span><span class='id identifier rubyid_stubbed'>stubbed</span> <span class='op'>=</span> <span class='id identifier rubyid_contentful_stub'>contentful_stub</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>my-content-type</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>id:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>1234</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>my_field:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>test</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

<span class='const'><span class='object_link'><a href="WCC.html" title="WCC (module)">WCC</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="WCC/Contentful.html" title="WCC::Contentful (module)">Contentful</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="WCC/Contentful/Model.html" title="WCC::Contentful::Model (class)">Model</a></span></span><span class='period'>.</span><span class='id identifier rubyid_find'><span class='object_link'><a href="WCC/Contentful/Model.html#find-class_method" title="WCC::Contentful::Model.find (method)">find</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>1234</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>==</span> <span class='id identifier rubyid_stubbed'>stubbed</span>
<span class='comment'># =&gt; true
</span>
<span class='const'>MyContentType</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>1234</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>==</span> <span class='id identifier rubyid_stubbed'>stubbed</span>
<span class='comment'># =&gt; true
</span>
<span class='const'>MyContentType</span><span class='period'>.</span><span class='id identifier rubyid_find_by'>find_by</span><span class='lparen'>(</span><span class='label'>my_field:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>test</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>==</span> <span class='id identifier rubyid_stubbed'>stubbed</span>
<span class='comment'># =&gt; true
</span></code></pre>

<h2 id="advanced-configuration-example">Advanced Configuration Example</h2>

<p>Here&#39;s an example containing all the configuration options, and a sample setup for
automatic deployment to Heroku.  This is intended to make you aware of what is possible,
and not as a general recommendation of what your setup should look like.</p>

<pre class="code ruby"><code class="ruby"># config/initializers/wcc_contentful.rb
WCC::Contentful.configure do |config|
  config.access_token = ENV[&#39;CONTENTFUL_ACCESS_TOKEN&#39;]
  config.space = ENV[&#39;CONTENTFUL_SPACE_ID&#39;]
  config.environment = ENV[&#39;CONTENTFUL_ENVIRONMENT&#39;]
  config.preview_token = ENV[&#39;CONTENTFUL_PREVIEW_ACCESS_TOKEN&#39;]

  # You may or may not want to provide this to your production server...
  config.management_token = ENV[&#39;CONTENTFUL_MANAGEMENT_TOKEN&#39;] unless Rails.env.production?

  config.app_url = &quot;https://#{ENV[&#39;HOSTNAME&#39;]}&quot;
  config.webhook_username = &#39;my-app-webhook&#39;
  config.webhook_password = Rails.application.secrets.webhook_password
  config.webhook_jobs &lt;&lt; MyOnWebhookJob

  config.store = :lazy_sync, Rails.cache if Rails.env.production?
  # config.store = MyCustomStore.new

  # Use a custom Faraday connection
  config.connection = Faraday.new do |builder|
    f.request :retry
    f.request MyFaradayRequestAdapter.new
    ...
  end
  # OR implement some adapter like this to use another HTTP client
  config.connection = MyNetHttpAdapter.new

  config.update_schema_file = :never
end

WCC::Contentful.init!
</code></pre>

<p>For Heroku:</p>

<pre class="code yaml"><code class="yaml"># Procfile
web: bundle exec rails s
worker: bundle exec sidekiq
release: bin/release
</code></pre>

<pre class="code sh"><code class="sh"># bin/release
#!/bin/sh

set -e

echo &quot;Migrating database...&quot;
bin/rake db:migrate

echo &quot;Migrating contentful...&quot;
migrations_to_be_run=$( ... ) # somehow figure this out
node_modules/.bin/contentful-migration \
    -s $CONTENTFUL_SPACE_ID -a $CONTENTFUL_MANAGEMENT_TOKEN \
    -y -p &quot;$migrations_to_be_run&quot;

echo &quot;Updating schema file...&quot;
rake wcc_contentful:download_schema
</code></pre>

<p>All configuration options can be found <a href="https://www.rubydoc.info/gems/wcc-contentful/WCC/Contentful/Configuration">in the rubydoc</a> under
<span class='object_link'><a href="WCC/Contentful/Configuration.html" title="WCC::Contentful::Configuration (class)">WCC::Contentful::Configuration</a></span></p>

<h2 id="development">Development</h2>

<p>After checking out the repo, run <code>bin/setup</code> to install dependencies. Then, run <code>bundle exec rspec</code> to run the tests. You can also run <code>bin/console</code> for an interactive prompt that will allow you to experiment.</p>

<h2 id="contributing">Contributing</h2>

<p>Bug reports and pull requests are welcome on GitHub at <a href="https://github.com/watermarkchurch/wcc-contentful">https://github.com/watermarkchurch/wcc-contentful</a>. This project is intended to be a safe, welcoming space for collaboration, and contributors are expected to adhere to the <a href="http://contributor-covenant.org">Contributor Covenant</a> code of conduct.</p>

<h2 id="license">License</h2>

<p>The gem is available as open source under the terms of the <a href="http://opensource.org/licenses/MIT">MIT License</a>.</p>

<h2 id="code-of-conduct">Code of Conduct</h2>

<p>Everyone interacting in the WCC::Contentful project&#39;s codebases, issue trackers, chat rooms and mailing lists is expected to follow the <a href="https://github.com/watermarkchurch/wcc-contentful/blob/master/CODE_OF_CONDUCT.md">code of conduct</a>.</p>
</div></div>

      <div id="footer">
  
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.26 (ruby-2.5.7).
</div>

    </div>
  </body>
</html>
